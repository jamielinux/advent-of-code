# Day 7: Part 2

## Instructions

<details>

<summary>Same as Part 1</summary>

You have input like this:

```
.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^...^.....
...............
....^...^.^....
...............
...^......^....
...............
..^..^...^..^..
...............
```

- The tachyon beam (`|`) starts at `S` and moves downwards.
- If it hits a splitter (`^`) then the beam is split on either side.
- If two beams overlap, they combine into one beam.
- Assumptions that aren't in the original instructions:
    - Splitters cannot be in adjacent cells.
    - There is always exactly one empty row in between rows with splitters.

In this example, the beam is split 12 times:

```
.......S.......
.......|.......
......|^|......
......|.|......
.....|^|^|.....
.....|.|.|.....
....|^|||^|....
....|..||.|....
...|^|.|^|^|...
...|.|.|.|.|...
..|^||.|.|^|...
..|.||.|.|.|...
.|^||^|||^||^..
.|.||.|||.||...
```

</details>

This time, it's the route that matters.

This is an example of one possible route:


```
.......S.......
.......|.......
......|^.......
......|........
.....|^.^......
.....|.........
....|^...^.....
....|..........
....^|..^.^....
.....|.........
...^.|....^....
.....|.........
..^..^|..^..^..
......|........
```

_Q: How many different routes can the beam take?_

## Notes

Following every possible route (several hundred billion iterations) would take
Ansible days or weeks, even with Jinja loops! ðŸ˜…

Instead, we can keep a running count of the number of overlapping beams in each
cell and use that to keep track of all the possibilities. That way, we actually
have the same number of iterations as Part 1.

My approach was to:

- parse the input into a list (rows) of lists (cells with a single character)
    - the rows of only dots are redundant, so drop these
- store beam positions as a list of column indexes
- store beam counts as a dict with integer keys representing the column index
- iterate through each row:
    - when encountering a splitter:
        - update beam positions
        - set beam count to zero for columns that had splitters, as there can
          never be a beam directly below a splitter
    - update the beam count for each cell by summing from the previous row:
        - the existing beam count at this column (ie, beams passing straight
          through from above)
        - the beam counts from adjacent columns if those columns had splitters
          (ie, beams splitting toward this column)
- sum all beam counts across the final row to get the total number of routes

## Playbook runtime

13 seconds.
